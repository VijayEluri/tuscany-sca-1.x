<?xml version="1.0"?>
<project name="project" default="createDistribution">

	<condition property="isSample">
		<and>
			<contains string="${project.groupId}" substring=".samples" />
			<or>
				<equals arg1="${project.packaging}" arg2="jar" />
				<equals arg1="${project.packaging}" arg2="war" />
			</or>
		</and>
	</condition>

	<condition property="isJar">
		<and>
			<not>
				<contains string="${project.groupId}" substring=".samples" />
			</not>
			<equals arg1="${project.packaging}" arg2="jar" />
		</and>
	</condition>

	<target name="createDistribution" depends="copySample, copyJar"/>

	<target name="copySample" if="isSample" description="Copy the sample code to the Tuscany distribution folder">
		<property name="target.folder" value="${dist.folder}/samples/${project.artifactId}" />
		<delete dir="${target.folder}" />
		<copy todir="${target.folder}">
			<fileset dir="${project.basedir}" includes="readme.htm, pom.xml">
				<include name="src/main/**" />
				<include name="target/${project.artifactId}-${project.version}.${project.packaging}" />
			</fileset>
		</copy>
	</target>

	<target name="copyJar" if="isJar" description="Copy the jar to the Tuscany distribution folder">
		<!--
		<copy todir="${dist.folder}/lib">
			<fileset dir="${project.basedir}/target">
				<include name="${project.artifactId}-${project.version}.${project.packaging}" />
			</fileset>
		</copy>
		-->
		<copy todir="${dist.folder}/javadoc">
			<fileset dir="${project.basedir}/target">
				<include name="${project.artifactId}-${project.version}-javadoc.${project.packaging}" />
			</fileset>
		</copy>
		<copy todir="${dist.folder}/javadoc/${project.artifactId}">
			<fileset dir="${project.basedir}/target/javadoc">
				<include name="**/*" />
			</fileset>
		</copy>
	</target>
	
	<target name="cleanDistribution" depends="cleanJar, cleanSample"/>
	
	<target name="cleanJar" if="isJar">
		<delete file="${dist.folder}/lib/${project.artifactId}-${project.version}.${project.packaging}" quiet="true"/>
		<delete file="${dist.folder}/javadoc/${project.artifactId}-${project.version}-javadoc.${project.packaging}" quiet="true"/>
		<delete dir="${dist.folder}/javadoc/${project.artifactId}" quiet="true"/>
	</target>
	
	<target name="cleanSample" if="isSample">
		<delete dir="${dist.folder}/samples/${project.artifactId}" quiet="true"/>
	</target>


</project>

