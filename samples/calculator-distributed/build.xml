<!--
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 * 
 *   http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations
 * under the License.    
-->
<project name="calculator" default="compile">
    <property name="test.class" value="calculator.CalculatorNodeExe" />
	<property name="test.jar"   value="sample-calculator.jar" />
	
	<!-- a classpath so I can test without building the distribution jars -->
	<property name="m2.repo"   value="C:\Documents and Settings\simon\.m2\repository" />
    <path id="test.classpath">
        <!--pathelement location="${classpath}"/-->
    	<pathelement location="${m2.repo}/org/apache/tuscany/sca/distributed-changes/1.0-incubating-SNAPSHOT/distributed-changes-1.0-incubating-SNAPSHOT.jar"/>    	
    	<pathelement location="${m2.repo}/org/apache/tuscany/sca/tuscany-interface-java-xml/1.0-incubating-SNAPSHOT/tuscany-interface-java-xml-1.0-incubating-SNAPSHOT.jar"/>
    	<pathelement location="${m2.repo}/wsdl4j/wsdl4j/1.6.2/wsdl4j-1.6.2.jar"/>
    	<pathelement location="${m2.repo}/org/apache/tuscany/sca/tuscany-implementation-java-xml/1.0-incubating-SNAPSHOT/tuscany-implementation-java-xml-1.0-incubating-SNAPSHOT.jar"/>
    	<pathelement location="${m2.repo}/org/codehaus/woodstox/wstx-asl/3.2.0/wstx-asl-3.2.0.jar"/>
    	<pathelement location="${m2.repo}/org/apache/tuscany/sca/tuscany-interface-wsdl/1.0-incubating-SNAPSHOT/tuscany-interface-wsdl-1.0-incubating-SNAPSHOT.jar"/>
    	<pathelement location="${m2.repo}/org/apache/tuscany/sca/tuscany-core-spi/1.0-incubating-SNAPSHOT/tuscany-core-spi-1.0-incubating-SNAPSHOT.jar"/>
    	<pathelement location="${m2.repo}/org/apache/tuscany/sca/tuscany-implementation-java/1.0-incubating-SNAPSHOT/tuscany-implementation-java-1.0-incubating-SNAPSHOT.jar"/>
    	<pathelement location="${m2.repo}/org/apache/tuscany/sca/tuscany-core-databinding/1.0-incubating-SNAPSHOT/tuscany-core-databinding-1.0-incubating-SNAPSHOT.jar"/>
    	<pathelement location="${m2.repo}/org/apache/tuscany/sca/tuscany-contribution-impl/1.0-incubating-SNAPSHOT/tuscany-contribution-impl-1.0-incubating-SNAPSHOT.jar"/>
    	<pathelement location="${m2.repo}/junit/junit/4.2/junit-4.2.jar"/>
    	<pathelement location="${m2.repo}/org/apache/tuscany/sca/tuscany-interface/1.0-incubating-SNAPSHOT/tuscany-interface-1.0-incubating-SNAPSHOT.jar"/>
    	<pathelement location="${m2.repo}/org/apache/tuscany/sca/tuscany-interface-java/1.0-incubating-SNAPSHOT/tuscany-interface-java-1.0-incubating-SNAPSHOT.jar"/>
    	<pathelement location="${m2.repo}/org/apache/tuscany/sca/sca-api/1.0-incubating-SNAPSHOT/sca-api-1.0-incubating-SNAPSHOT.jar"/>
    	<pathelement location="${m2.repo}/org/apache/tuscany/sca/tuscany-implementation-java-runtime/1.0-incubating-SNAPSHOT/tuscany-implementation-java-runtime-1.0-incubating-SNAPSHOT.jar"/>
    	<pathelement location="${m2.repo}/stax/stax-api/1.0.1/stax-api-1.0.1.jar"/>
    	<pathelement location="${m2.repo}/org/apache/tuscany/sca/tuscany-core/1.0-incubating-SNAPSHOT/tuscany-core-1.0-incubating-SNAPSHOT.jar"/>
    	<pathelement location="${m2.repo}/org/apache/tuscany/sca/tuscany-assembly-xml/1.0-incubating-SNAPSHOT/tuscany-assembly-xml-1.0-incubating-SNAPSHOT.jar"/>
    	<pathelement location="${m2.repo}/org/apache/tuscany/sca/tuscany-assembly/1.0-incubating-SNAPSHOT/tuscany-assembly-1.0-incubating-SNAPSHOT.jar"/>
    	<pathelement location="${m2.repo}/org/apache/ws/commons/schema/XmlSchema/1.3.1/XmlSchema-1.3.1.jar"/>
    	<pathelement location="${m2.repo}/org/apache/tuscany/sca/tuscany-policy/1.0-incubating-SNAPSHOT/tuscany-policy-1.0-incubating-SNAPSHOT.jar"/>
    	<pathelement location="${m2.repo}/org/apache/tuscany/sca/tuscany-interface-wsdl-xml/1.0-incubating-SNAPSHOT/tuscany-interface-wsdl-xml-1.0-incubating-SNAPSHOT.jar"/>
    	<pathelement location="${m2.repo}/org/apache/tuscany/commonj-api/1.0-incubating-SNAPSHOT/commonj-api-1.0-incubating-SNAPSHOT.jar"/>
    	<pathelement location="${m2.repo}/org/apache/tuscany/sca/tuscany-contribution/1.0-incubating-SNAPSHOT/tuscany-contribution-1.0-incubating-SNAPSHOT.jar"/>
    	<pathelement location="${m2.repo}/org/apache/tuscany/sca/tuscany-databinding/1.0-incubating-SNAPSHOT/tuscany-databinding-1.0-incubating-SNAPSHOT.jar"/>
    	<pathelement location="${m2.repo}/org/apache/tuscany/sca/tuscany-host-embedded/1.0-incubating-SNAPSHOT/tuscany-host-embedded-1.0-incubating-SNAPSHOT.jar"/>
    	<pathelement location="${m2.repo}/org/apache/tuscany/sca/tuscany-binding-jms/1.0-incubating-SNAPSHOT/tuscany-binding-jms-1.0-incubating-SNAPSHOT.jar"/>
    	<pathelement location="${m2.repo}/org/apache/activemq/apache-activemq/4.1.1/apache-activemq-4.1.1.jar"/>
    	<!--pathelement location="${m2.repo}/org/apache/activemq/apache-activemq/4.2-SNAPSHOT/apache-activemq-4.2-SNAPSHOT.jar"/-->
    	<pathelement location="${m2.repo}/org/apache/tuscany/sca/tuscany-binding-sca/1.0-incubating-SNAPSHOT/tuscany-binding-sca-1.0-incubating-SNAPSHOT.jar"/>    	
    	<pathelement location="${m2.repo}/org/apache/tuscany/sca/tuscany-distributed/1.0-incubating-SNAPSHOT/tuscany-distributed-1.0-incubating-SNAPSHOT.jar"/>
    	<pathelement location="${m2.repo}/org/apache/tuscany/sca/tuscany-topology/1.0-incubating-SNAPSHOT/tuscany-topology-1.0-incubating-SNAPSHOT.jar"/>
    	<pathelement location="${m2.repo}/org/apache/tuscany/sca/tuscany-topology-xml/1.0-incubating-SNAPSHOT/tuscany-topology-xml-1.0-incubating-SNAPSHOT.jar"/>    	
    	<pathelement location="target/classes"/>    	
    </path>	
    		
    <target name="init">
        <mkdir dir="target/classes"/>
    </target>
	
    <target name="compile" depends="init">
        <javac srcdir="src/main/java"
               destdir="target/classes"
               debug="on"
               source="1.5"
               target="1.5">
            <classpath>
            	<pathelement location="../../lib/tuscany-sca-manifest.jar"/>
            </classpath>
        </javac> 
        <copy todir="target/classes">
            <fileset dir="src/main/resources"/>
        </copy>
        <jar destfile="target/${test.jar}" basedir="target/classes">
            <manifest>
                <attribute name="Main-Class" value="${test.class}" /> 
            </manifest>
        </jar>    	
    </target>	
	
    <target name="runA">
        <java classname="${test.class}"
              fork="true">
            <classpath>
                <!--pathelement path="target/classes"/-->
            	<!--pathelement location="../../lib/tuscany-sca-manifest.jar"/-->
            	<path refid="test.classpath"/>
            </classpath>
        	<arg value="nodeA"/>        	        	
        </java>
    </target>
	
    <target name="runB">
        <java classname="${test.class}"
              fork="true">
            <classpath>
                <!--pathelement path="target/classes"/-->
            	<!--pathelement location="../../lib/tuscany-sca-manifest.jar"/-->
            	<path refid="test.classpath"/>
            </classpath>
        	<arg value="nodeB"/>        	
        </java>
    </target>	
	
    <target name="runC">
        <java classname="${test.class}"
              fork="true">
            <classpath>
                <!--pathelement path="target/classes"/-->
            	<!--pathelement location="../../lib/tuscany-sca-manifest.jar"/-->
            	<path refid="test.classpath"/>
            </classpath>
        	<arg value="nodeC"/>        	
        </java>
    </target>	
	
    <target name="clean">
        <delete quiet="true" includeemptydirs="true">
            <fileset dir="target"/>
        </delete>
    </target>
</project>
